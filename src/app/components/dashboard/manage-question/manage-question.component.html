<div class="modal fade" id="manageQuestionsModal" tabindex="-1" aria-labelledby="manageQuestionsModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="manageQuestionsModalLabel">Manage Questions for {{ exam?.title || 'Exam' }}</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <button class="btn btn-primary mb-3" (click)="modalService.open(addQuestionModal)">Add Question</button>
        <ul class="list-group">
          @for (question of questions; track question.id) {
            <li class="list-group-item d-flex justify-content-between align-items-center">
              <span>{{ question.questionText }}</span>
              <div>
                <button
                  class="btn btn-outline-primary btn-sm me-2"
                  (click)="openEditQuestionModal(content, question)"
                >
                  Edit
                </button>
                <button class="btn btn-outline-danger btn-sm">Delete</button>
              </div>
            </li>
          } @empty {
            <li class="list-group-item text-muted">No questions available.</li>
          }
        </ul>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="modalService.dismissAll()">Close</button>
      </div>
    </div>
  </div>
</div>

<ng-template #content let-modal>
  <div class="modal-header">
    <h5 class="modal-title" id="editQuestionModalLabel">Edit Question</h5>
    <button type="button" class="btn-close" (click)="modal.dismiss('Cross click')" aria-label="Close"></button>
  </div>
  <div class="modal-body">
    <form *ngIf="selectedQuestion" (ngSubmit)="updateQuestion()" #editQuestionForm="ngForm">
      <div class="mb-3">
        <label for="editQuestionText" class="form-label">Question Text</label>
        <input
          type="text"
          class="form-control"
          id="editQuestionText"
          [(ngModel)]="selectedQuestion.questionText"
          name="questionText"
          required
        />
      </div>
      <div class="mb-3" *ngFor="let option of selectedQuestion.options; let i = index">
        <label [for]="'option' + i" class="form-label">Option {{ i + 1 }}</label>
        <input
          type="text"
          class="form-control"
          [id]="'option' + i"
          [(ngModel)]="selectedQuestion.options[i]"
          [name]="'option' + i"
          required
        />
      </div>
      <div class="mb-3">
        <label for="editCorrectAnswer" class="form-label">Correct Answer</label>
        <select
          class="form-select"
          id="editCorrectAnswer"
          [(ngModel)]="selectedQuestion.correctAnswer"
          name="correctAnswer"
          required
        >
          <option *ngFor="let option of selectedQuestion.options; let i = index" [value]="option">
            Option {{ i + 1 }}: {{ option }}
          </option>
        </select>
      </div>
      <button type="submit" class="btn btn-primary" [disabled]="!editQuestionForm.valid">Save Changes</button>
    </form>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-secondary" (click)="modal.dismiss('Close click')">Close</button>
  </div>
</ng-template>

<ng-template #addQuestionModal let-modal>
  <div class="modal-header">
    <h5 class="modal-title">Add Question</h5>
    <button type="button" class="btn-close" (click)="modal.dismiss('Cross click')" aria-label="Close"></button>
  </div>
  <div class="modal-body">
    <p>Implement Add Question form logic here.</p>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-secondary" (click)="modal.dismiss('Close click')">Close</button>
    <button type="button" class="btn btn-primary">Add Question</button>
  </div>
</ng-template>
